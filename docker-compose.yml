services:
  # TOOD: add real database like postgres, for this project, used sqlite. 
  backend:
    image: '${DOCKER_IMAGE_BACKEND?Variable not set}:${TAG-latest}'
    restart: always
    env_file:
      - .env
    environment:
      - ENVIRONMENT=${ENVIRONMENT}
      - BACKEND_CORS_ORIGINS=${BACKEND_CORS_ORIGINS}
      - SECRET_KEY=${SECRET_KEY?Variable not set}
      - USERS_OPEN_REGISTRATION=${USERS_OPEN_REGISTRATION}
      - DOCKER_HOST=unix:///var/run/docker.sock
    build:
      context: ./backend
      args:
        INSTALL_DEV: ${INSTALL_DEV-false}
    volumes:
      - ./backend:/app/
      - /var/run/docker.sock:/var/run/docker.sock
    ports:
      - "80:80"